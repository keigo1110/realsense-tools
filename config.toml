# Jump Analyzer 設定ファイル
# このファイルを config.toml にコピーして使用してください
# コマンドライン引数は設定ファイルの値を上書きします

# 入力・出力パス
input = "record/nakamura_suityoku_yoko.bag"  # 入力.bagファイルパス（またはディレクトリ）
output = "results/"  # 出力ディレクトリ
dual = false  # デュアルカメラモード（trueの場合、inputにディレクトリを指定すると自動で*_metadata.jsonを検出）

# モデル設定
pose_model = "yolov8"  # 姿勢推定モデルタイプ: "yolov8" (高速) または "vitpose" (最高精度)
model_dir = "models"  # モデルファイルのディレクトリ
model_name = "yolov8x-pose.pt"  # モデル名: YOLOv8の場合 (yolov8n-pose.pt, yolov8s-pose.pt, yolov8m-pose.pt, yolov8l-pose.pt, yolov8x-pose.pt), ViTPoseの場合 (vitpose-huge, vitpose-large, vitpose-base, vitpose-small, vitpose-tiny)

# ジャンプ検出閾値
threshold_vertical = 0.05  # 垂直ジャンプ検出閾値（メートル）
threshold_horizontal = 0.1  # 水平ジャンプ検出閾値（メートル）
min_jump_height = 0.20  # 有効なジャンプと認識する最小高さ（メートル、デフォルト: 20cm、20cm以下は除外）
min_air_time = 0.20  # 有効なジャンプと認識する最小滞空時間（秒、デフォルト: 200ms）

# 出力オプション
enable_video = true  # ビデオ出力を有効化（true: 出力する、false: スキップ）
enable_3d_animation = true  # 3Dアニメーションを有効化（true: 生成する、false: スキップ）
interactive_3d = true  # インタラクティブ3Dアニメーションを表示

# キーポイントスムージング
smooth_keypoints = true  # キーポイントスムージングを有効化（falseの場合は無効、trueの場合はsmooth_window_sizeを使用）
smooth_window_size = 10  # 移動平均のウィンドウサイズ（smooth_keypoints: trueの場合に使用、振動を減らすため10に増加）

# 深度データ処理
enable_depth_interpolation = true  # 深度補間を有効化（true: 補間する、false: 単一ピクセルを使用）
depth_kernel_size = 5  # 深度補間カーネルサイズ（3, 5, 7など、振動を減らすため5に増加）

# カルマンフィルタ（高度なスムージング、推奨）
use_kalman_filter = true  # カルマンフィルタを使用（smooth_keypointsより高精度だが遅い）
kalman_process_noise = 0.005  # カルマンフィルタ処理ノイズ（小さいほど滑らか、振動を減らすため0.005に減少）
kalman_measurement_noise = 0.15  # カルマンフィルタ測定ノイズ（大きいほど予測を信頼、振動を減らすため0.15に増加）

# 床検出（高精度なジャンプ検出）
enable_floor_detection = true  # 床検出を有効化（true: 床検出を使用、false: 従来の高さベース検出を使用）

# 腰基準ジャンプ検出（床からの距離をゼロクロスで判定）
waist_baseline_height = 0.85  # 床から腰までの基準高さ（メートル）
waist_zero_epsilon = 0.01     # ゼロ判定のデッドバンド幅（メートル）

# 再生時間範囲（秒）
# 0の場合は最初から/最後まで（nullは使えないので0で代用）
start_time = 0.0    # 開始時間（秒、0の場合は最初から）
end_time = 0.0      # 終了時間（秒、0の場合は最後まで）

# 高速化オプション
frame_skip = 1  # Nフレームおきに処理（1=全フレーム、2=2フレームおき、など）
resize_factor = 1.0  # 画像リサイズ係数（1.0=リサイズなし、0.5=半分のサイズ）
minimal_data = false  # JSONにジャンプ検出フレームのみ保存（高速化、ファイルサイズ削減）

